diff -ru dpkg-1.8.3.1/Makefile.in dpkg-1.8.3.1-patched/Makefile.in
--- dpkg-1.8.3.1/Makefile.in	Sun Nov 12 15:25:56 2000
+++ dpkg-1.8.3.1-patched/Makefile.in	Thu May 24 21:40:02 2001
@@ -14,8 +14,8 @@
 all: version.h all-recursive
 
 install: all install-recursive
-	$(mkinstalldirs) $(dpkgconfdir)/origins
-	$(INSTALL_DATA) $(srcdir)/origin $(dpkgconfdir)/origins/debian
+	$(mkinstalldirs) $(DESTDIR)/$(dpkgconfdir)/origins
+	$(INSTALL_DATA) $(srcdir)/origin $(DESTDIR)/$(dpkgconfdir)/origins/debian
 
 clean: clean-recursive
 	rm -f $(GENFILES)
diff -ru dpkg-1.8.3.1/archtable dpkg-1.8.3.1-patched/archtable
--- dpkg-1.8.3.1/archtable	Fri Jan 12 14:55:49 2001
+++ dpkg-1.8.3.1-patched/archtable	Thu May 24 21:40:02 2001
@@ -43,4 +43,6 @@
 s390-linux-gnu		s390		s390
 s390-ibm-linux-gnu	s390		s390
 s390-unknown-linux-gnu	s390		s390
+powerpc-darwin		darwin-powerpc	darwin-powerpc
+i386-darwin		darwin-i386	darwin-i386
 
diff -ru dpkg-1.8.3.1/lib/Makefile.in dpkg-1.8.3.1-patched/lib/Makefile.in
--- dpkg-1.8.3.1/lib/Makefile.in	Sun May 21 19:22:34 2000
+++ dpkg-1.8.3.1-patched/lib/Makefile.in	Thu May 24 21:40:02 2001
@@ -16,9 +16,10 @@
 
 .PHONY: all
 all:: libdpkg.a
-	
+
 libdpkg.a: $(OBJECTS)
 	$(AR) r $@ $^
+	ranlib $@
 
 .PHONY: install
 install:: all
diff -ru dpkg-1.8.3.1/main/archives.c dpkg-1.8.3.1-patched/main/archives.c
--- dpkg-1.8.3.1/main/archives.c	Fri Jan 12 17:02:12 2001
+++ dpkg-1.8.3.1-patched/main/archives.c	Thu May 24 21:40:02 2001
@@ -47,6 +47,24 @@
 struct pkginfo *conflictor[20];
 int cflict_index = 0;
 
+/* special routine to handle partial reads from the tarfile */
+static int safe_read(int fd, void *buf, int len)
+{
+  int r, have = 0;
+  char *p = (char *)buf;
+  while (have < len) {
+    if ((r = read(fd,p,len-have)) == -1) {
+      if (errno == EINTR || errno == EAGAIN) continue;
+      return r;
+    }
+    if (r == 0)
+      break;
+    have += r;
+    p += r;
+  }
+  return have;
+}
+
 int filesavespackage(struct fileinlist *file, struct pkginfo *pkgtobesaved,
                      struct pkginfo *pkgbeinginstalled) {
   struct pkginfo *divpkg, *thirdpkg;
@@ -118,7 +136,7 @@
 int tarfileread(void *ud, char *buf, int len) {
   struct tarcontext *tc= (struct tarcontext*)ud;
   int r;
-  if ((r= read(tc->backendpipe,buf,len)) == -1)
+  if ((r= safe_read(tc->backendpipe,buf,len)) == -1)
     ohshite(_("error reading from dpkg-deb pipe"));
   return r;
 }
@@ -396,7 +414,7 @@
           (unsigned long)ti->Size);
     fd_fd_copy(tc->backendpipe, fd, ti->Size, _("backend dpkg-deb during `%.255s'"),ti->Name);
     r= ti->Size % TARBLKSZ;
-    if (r > 0) r= read(tc->backendpipe,databuf,TARBLKSZ - r);
+    if (r > 0) r= safe_read(tc->backendpipe,databuf,TARBLKSZ - r);
     if (nifd->namenode->statoverride) 
       debug(dbg_eachfile, "tarobject ... stat override, uid=%d, gid=%d, mode=%04o",
 			  nifd->namenode->statoverride->uid,
@@ -442,12 +460,10 @@
     debug(dbg_eachfiledetail,"tarobject SymbolicLink creating");
 #ifdef HAVE_LCHOWN
     if (lchown(fnamenewvb.buf,
-#else
-    if (chown(fnamenewvb.buf,
-#endif
 	    nifd->namenode->statoverride ? nifd->namenode->statoverride->uid : ti->UserID,
 	    nifd->namenode->statoverride ? nifd->namenode->statoverride->gid : ti->GroupID))
       ohshite(_("error setting ownership of symlink `%.255s'"),ti->Name);
+#endif
     break;
   case Directory:
     /* We've already checked for an existing directory. */
@@ -503,10 +519,8 @@
         ohshite(_("unable to make backup symlink for `%.255s'"),ti->Name);
 #ifdef HAVE_LCHOWN
       if (lchown(fnametmpvb.buf,stab.st_uid,stab.st_gid))
-#else
-      if (chown(fnametmpvb.buf,stab.st_uid,stab.st_gid))
-#endif
         ohshite(_("unable to chown backup symlink for `%.255s'"),ti->Name);
+#endif
     } else {
       debug(dbg_eachfiledetail,"tarobject nondirectory, `link' backup");
       if (link(fnamevb.buf,fnametmpvb.buf))
diff -ru dpkg-1.8.3.1/main/configure.c dpkg-1.8.3.1-patched/main/configure.c
--- dpkg-1.8.3.1/main/configure.c	Thu Aug 24 22:34:56 2000
+++ dpkg-1.8.3.1-patched/main/configure.c	Thu May 24 21:40:02 2001
@@ -340,8 +340,10 @@
           " I do not mess up your careful work.\n"),
                     cdr.buf, cdr2.buf);
 
+#ifndef __APPLE__
             s= getenv(NOJOBCTRLSTOPENV);
             if (s && *s) {
+#endif
               fputs(_("Type `exit' when you're done.\n"),stderr);
               if (!(c1= m_fork())) {
                 s= getenv(SHELLENV);
@@ -351,11 +353,13 @@
               }
               while ((r= waitpid(c1,&status,0)) == -1 && errno == EINTR);
               if (r != c1) { onerr_abort++; ohshite(_("wait for shell failed")); }
+#ifndef __APPLE__
             } else {
               fputs(_("Don't forget to foreground (`fg') this "
                     "process when you're done !\n"),stderr);
               kill(-getpgid(0),SIGTSTP);
             }
+#endif
           }
 
         } while (!strchr("yino",cc));
diff -ru dpkg-1.8.3.1/main/help.c dpkg-1.8.3.1-patched/main/help.c
--- dpkg-1.8.3.1/main/help.c	Fri Jan 12 17:02:12 2001
+++ dpkg-1.8.3.1-patched/main/help.c	Thu May 24 21:40:02 2001
@@ -69,7 +69,7 @@
 
 void checkpath(void) {
 /* Verify that some programs can be found in the PATH. */
-  static const char *const checklist[]= { "ldconfig", 
+  static const char *const checklist[]= {
 #ifdef USE_START_STOP_DAEMON
     "start-stop-daemon",
 #endif    
diff -ru dpkg-1.8.3.1/optlib/Makefile.in dpkg-1.8.3.1-patched/optlib/Makefile.in
--- dpkg-1.8.3.1/optlib/Makefile.in	Wed Dec 15 16:29:16 1999
+++ dpkg-1.8.3.1-patched/optlib/Makefile.in	Thu May 24 21:40:02 2001
@@ -11,9 +11,10 @@
 
 .PHONY: all
 all:: libopt.a
-	
+
 libopt.a: $(OBJECTS)
 	$(AR) r $@ $^
+	ranlib $@
 
 .PHONY: install
 install:: all
diff -ru dpkg-1.8.3.1/po/Makefile.in.in dpkg-1.8.3.1-patched/po/Makefile.in.in
--- dpkg-1.8.3.1/po/Makefile.in.in	Sat Jan 13 14:57:56 2001
+++ dpkg-1.8.3.1-patched/po/Makefile.in.in	Thu May 24 21:40:02 2001
@@ -119,8 +119,8 @@
 	for cat in $$catalogs; do \
 	  cat=`basename $$cat`; \
 	  case "$$cat" in \
-	    *.gmo) destdir=$(gnulocaledir);; \
-	    *)     destdir=$(localedir);; \
+	    *.gmo) destdir=$(DESTDIR)/$(gnulocaledir);; \
+	    *)     destdir=$(DESTDIR)/$(localedir);; \
 	  esac; \
 	  lang=`echo $$cat | sed 's/\$(CATOBJEXT)$$//'`; \
 	  dir=$$destdir/$$lang/LC_MESSAGES; \
diff -ru dpkg-1.8.3.1/scripts/dpkg-architecture.pl dpkg-1.8.3.1-patched/scripts/dpkg-architecture.pl
--- dpkg-1.8.3.1/scripts/dpkg-architecture.pl	Fri Jan 12 14:56:09 2001
+++ dpkg-1.8.3.1-patched/scripts/dpkg-architecture.pl	Thu May 24 21:40:02 2001
@@ -61,7 +61,9 @@
 	    'hppa',      'hppa-linux',
 	    'hurd-i386', 'i386-gnu',
 	    's390',	 's390-linux',
-	    'freebsd-i386', 'i386-freebsd');
+	    'freebsd-i386', 'i386-freebsd',
+	    'darwin-powerpc', 'powerpc-darwin',
+	    'darwin-i386', 'i386-darwin');
 
 sub usageversion {
     print STDERR
diff -ru dpkg-1.8.3.1/scripts/update-alternatives.pl dpkg-1.8.3.1-patched/scripts/update-alternatives.pl
--- dpkg-1.8.3.1/scripts/update-alternatives.pl	Fri Jan 12 14:56:10 2001
+++ dpkg-1.8.3.1-patched/scripts/update-alternatives.pl	Thu May 24 21:48:52 2001
@@ -51,7 +51,7 @@
 sub quit { print STDERR "update-alternatives: @_\n"; exit(2); }
 sub badusage { print STDERR "update-alternatives: @_\n\n"; &usageversion; exit(2); }
 
-$altdir= '/etc/alternatives';
+$altdir= '@PREFIX@/etc/alternatives';
 $admindir= '/var/lib/dpkg' . '/alternatives';
 $testmode= 0;
 $verbosemode= 0;
